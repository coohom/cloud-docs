<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>SLAM - MINERVAS Help Document</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../dsl.html"><strong aria-hidden="true">2.</strong> DSL Programing Guide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../scene_processor.html"><strong aria-hidden="true">2.1.</strong> Scene Processor</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../room.html"><strong aria-hidden="true">2.1.1.</strong> Room</a></li><li class="chapter-item expanded "><a href="../level.html"><strong aria-hidden="true">2.1.2.</strong> Level</a></li></ol></li><li class="chapter-item expanded "><a href="../entity_processor.html"><strong aria-hidden="true">2.2.</strong> Entity Processor</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../dsl/camera.html"><strong aria-hidden="true">2.2.1.</strong> Camera</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../dsl/perspective_camera.html"><strong aria-hidden="true">2.2.1.1.</strong> PerspectiveCamera</a></li><li class="chapter-item expanded "><a href="../dsl/orthographic_camera.html"><strong aria-hidden="true">2.2.1.2.</strong> OrthographicCamera</a></li><li class="chapter-item expanded "><a href="../dsl/panoramic_camera.html"><strong aria-hidden="true">2.2.1.3.</strong> PanoramicCamera</a></li></ol></li><li class="chapter-item expanded "><a href="../dsl/light.html"><strong aria-hidden="true">2.2.2.</strong> Light</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../dsl/point_light.html"><strong aria-hidden="true">2.2.2.1.</strong> PointLight</a></li><li class="chapter-item expanded "><a href="../dsl/rectangle_light.html"><strong aria-hidden="true">2.2.2.2.</strong> RectangleLight</a></li><li class="chapter-item expanded "><a href="../dsl/sun_light.html"><strong aria-hidden="true">2.2.2.3.</strong> Sunlight</a></li><li class="chapter-item expanded "><a href="../dsl/iesspot_light.html"><strong aria-hidden="true">2.2.2.4.</strong> IESspotLight</a></li></ol></li><li class="chapter-item expanded "><a href="../dsl/instance.html"><strong aria-hidden="true">2.2.3.</strong> Instance</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../dsl/material.html"><strong aria-hidden="true">2.2.3.1.</strong> Material</a></li><li class="chapter-item expanded "><a href="../dsl/mesh.html"><strong aria-hidden="true">2.2.3.2.</strong> Model</a></li></ol></li><li class="chapter-item expanded "><a href="../dsl/trajectory.html"><strong aria-hidden="true">2.2.4.</strong> Trajectory</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../dsl/random_trajectory.html"><strong aria-hidden="true">2.2.4.1.</strong> RandomTrajectory</a></li><li class="chapter-item expanded "><a href="../dsl/converage_trajectory.html"><strong aria-hidden="true">2.2.4.2.</strong> CoverageTrajectory</a></li><li class="chapter-item expanded "><a href="../dsl/defined_trajectory.html"><strong aria-hidden="true">2.2.4.3.</strong> DefinedTrajectory</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../render_processor.html"><strong aria-hidden="true">2.3.</strong> Render Processor</a></li><li class="chapter-item expanded "><a href="../pixel_processor.html"><strong aria-hidden="true">2.4.</strong> Pixel Processor</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../dsl/pixel_process/output_selection.html"><strong aria-hidden="true">2.4.1.</strong> Output Selection</a></li><li class="chapter-item expanded "><a href="../dsl/pixel_process/noise.html"><strong aria-hidden="true">2.4.2.</strong> Noise Simulation</a></li><li class="chapter-item expanded "><a href="../dsl/pixel_process/distortion.html"><strong aria-hidden="true">2.4.3.</strong> Distortion Simulation</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../examples.html"><strong aria-hidden="true">3.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../examples/layout_estimation.html"><strong aria-hidden="true">3.1.</strong> Layout Estimation</a></li><li class="chapter-item expanded "><a href="../examples/semantic_segmentation.html"><strong aria-hidden="true">3.2.</strong> Semantic Segmentation</a></li><li class="chapter-item expanded "><a href="../examples/depth_estimation.html"><strong aria-hidden="true">3.3.</strong> Depth Estimation</a></li><li class="chapter-item expanded "><a href="../examples/trajectory_sampling.html" class="active"><strong aria-hidden="true">3.4.</strong> SLAM</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">MINERVAS Help Document</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#slam" id="slam">SLAM</a></h1>
<h2><a class="header" href="#introduction" id="introduction">Introduction</a></h2>
<p>Simultaneous localization and mapping (SLAM) is the computational problem of constructing or updating a map of an unknown environment while simultaneously keeping track of an agent's location within it<a href="#2"><sup>1</sup></a>.
Real-time, high-quality, 3D scanning of large-scale scenes is key to mixed reality and robotic applications like SLAM. 
In dense SLAM, a space is mapped by fusing the data from a
moving sensor into a representation of the continuous surfaces. </p>
<p>In this experiment, we utilize our system for the
SLAM learning task by generating images from a sequence
of camera views, generated by our trajectory sampler.</p>
<h2><a class="header" href="#dsl-code" id="dsl-code">DSL code</a></h2>
<p>First, we import some necessary packages.</p>
<pre><code class="language-python">from ksecs.ECS.processors.entity_processor import EntityProcessor
import glm
</code></pre>
<p>Our system give users the ability to create their custom camera trajectory.</p>
<!-- The ECS-D architecture and basic sampler give users the ability to create their scene sample strategy.  -->
<p>We show an example of custom trajectory sampler DSL below. </p>
<pre><code class="language-python">class CustomTrajectorySampler(EntityProcessor):

    def calculate_vel(self, velocity, step_time):
        mu = glm.normalize(glm.vec2(np.random.normal(0, 1, size=2)))
        FORCE = 100
        f = FORCE * mu
        PHI, A, C_D, M = 1.204, 0.09, 0.1, 1.0
        d = -0.5 * glm.normalize(velocity) * PHI * A * C_D * glm.dot(velocity, velocity)
        velocity = velocity + (d + f) * M * step_time
        S_MAX = 10
        if S_MAX &lt; sqrt(glm.dot(velocity, velocity)):
            velocity = S_MAX * glm.normalize(velocity)
        return velocity

    def process(self):
        for camera in self.shader.world.cameras:
            self.shader.world.delete_entity(camera)

        key_points = []
        for room in self.shader.world.rooms:
            # init
            room_points = []
            room_polygon = room.gen_polygon()
            camera_vel = glm.normalize(glm.vec2(np.random.normal(0, 1, size=2)))
            camera_pos = glm.vec2(room.position)
            # calcaulate road points
            length_of_trajectory, delta_time, scale = 100, 0.03, 1000
            for i in range(length_of_trajectory):
                # Camera
                camera_vel = self.calculate_vel(camera_vel, delta_time)
                new_position = camera_pos + scale * camera_vel * delta_time
                next_camera_point = Point(tuple(new_position.xy))
                if not next_camera_point.within(room_polygon):
                    p1, p2 = nearest_points(room_polygon, next_camera_point)
                    normal = glm.normalize(glm.vec2(p1.x - p2.x, p1.y - p2.y))
                    camera_vel = glm.reflect(camera_vel, normal)
                camera_pos = camera_pos + scale * camera_vel * delta_time
                room_points.append(list(camera_pos))

            key_points.append(room_points)

        self.make_traj(
            imageHeight=480,
            imageWidth=640,
            keyPoints=key_points,
            speed=1200,
            fps=3,
            speedMode=1,
            pitchMode=1,
            pitch=[-10, 10],
            hfov=70,
            vfov=55,
            height=1400,
            heightMode=1,
            cameraType=&quot;PERSPECTIVE&quot;
        )
</code></pre>
<h2><a class="header" href="#minervas-output-samples" id="minervas-output-samples">MINERVAS output samples</a></h2>
<p>After running with the DSL above, we can get a sequence of images (color and depth) along camera trajectory as shown below.</p>
<p><img src="./../examples_figs/trajectory.png" alt="trajectory_output" /></p>
<!-- ## Experimental Setup -->
<!-- ## Result
We evaluated the usability of our system in this field based on the open source SLAM algorithm Bundlefusion [[2]](#2)
A qualitative result is shown below. Scenes can 
be robustly reconstructed, as well as the textures of objects. 
This demonstrates that our pipeline can output the proposed 
dataset for the SLAM algorithm, and that the generated trajectory provides a good view of the interior. The results of our experiments indicate that our synthetic scenes with configurable attributes and background can be utilized to diagnose the SLAM algorithm. -->
<!-- ![trajectory_output](./../examples_figs/fig_3d_reconstruction.png) -->
<h2><a class="header" href="#references" id="references">References</a></h2>
<p><a id="1">[1]</a> 
wikipedia. Simultaneous localization and mapping. <a href="https://en.wikipedia.org/wiki/Simultaneous_localization_and_mapping">https://en.wikipedia.org/wiki/Simultaneous_localization_and_mapping</a>.</p>
<!-- <a id="2">[2]</a> 
Angela Dai, Matthias Nießner, Michael Zollhöfer, Shahram Izadi, and Christian Theobalt. Bundlefusion: Real-time globally consistent 3d reconstruction using on-the-fly surface reintegration. ACM Transactions on Graphics (TOG), 36(4):1, 2017. -->
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../examples/depth_estimation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../examples/depth_estimation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
